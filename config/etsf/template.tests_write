!! NOTES
!!  This file has been automatically generated by the @SCRIPT@
!!  script. Any change you would bring to it will systematically be
!!  overwritten. See the template file in config/etsf/template.tests.

program tests_write

  use etsf_io_low_level
  use etsf_io
  
  implicit none

  call test_data_write()
@CALL_WRITE_GROUP@
  
contains

  subroutine tests_write_status(name, lstat, error)
    character(len = *), intent(in)      :: name
    logical, intent(in)                 :: lstat
    type(etsf_io_low_error), intent(in) :: error
    
    if (lstat) then
      write(*, "(A,A,A,A)") "== ", name, repeat(" ", 68 - len(name)), "OK     =="
    else
      write(*, "(A,A,A,A)") "== ", name, repeat(" ", 68 - len(name)), "Failed =="
      call etsf_io_low_error_handle(error)
    end if
  end subroutine tests_write_status
  
  subroutine test_data_write()
    type(etsf_groups) :: grp
    integer :: ncid
    type(etsf_io_low_error) :: error
    type(etsf_io_low_var_double) :: var
    character(len = *), parameter :: me = "test_data_write"
    logical :: lstat

    write(*,*)
    write(*,*) "Testing etsf_io_data_write()..."

    call etsf_io_data_write("pouet", etsf_grp_none, grp, lstat, error)
    call tests_write_status("filename: wrong value (no file)", (.not. lstat), error)
    
    call etsf_io_data_write("Makefile", etsf_grp_none, grp, lstat, error)
    call tests_write_status("filename: wrong value (text file)", (.not. lstat), error)

    call etsf_io_data_write("test_density.nc", -1, grp, lstat, error)
    call tests_write_status("groups: wrong value", (.not. lstat), error)

    write(*,*)

  end subroutine test_data_write

@WRITE_GRP@

end program tests_write
