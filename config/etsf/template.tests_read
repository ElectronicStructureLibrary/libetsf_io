!! NOTES
!!  This file has been automatically generated by the config/scripts/autogen_tests.py
!!  script. Any change you would bring to it will systematically be
!!  overwritten. See the template file in config/etsf/template.tests_read.

program tests_read

  use etsf_io_low_level
  use etsf_io
  
  implicit none

  call test_data_read()
@CALL_READ_GROUP@
  
contains

  subroutine tests_read_status(name, lstat, error)
    character(len = *), intent(in)      :: name
    logical, intent(in)                 :: lstat
    type(etsf_io_low_error), intent(in) :: error
    
    if (lstat) then
      write(*, "(A,A,A,A)") "== ", name, repeat(" ", 68 - len(name)), "OK     =="
    else
      write(*, "(A,A,A,A)") "== ", name, repeat(" ", 68 - len(name)), "Failed =="
      call etsf_io_low_error_handle(error)
    end if
  end subroutine tests_read_status

  subroutine test_data_read()
    type(etsf_groups) :: grp
    integer :: ncid
    type(etsf_io_low_error) :: error
    type(etsf_io_low_var_double) :: var
    character(len = *), parameter :: me = "test_data_read"
    logical :: lstat

    write(*,*)
    write(*,*) "Testing etsf_io_data_read()..."

    call etsf_io_data_read("pouet", grp, lstat, error)
    call tests_read_status("filename: wrong value (no file)", (.not. lstat), error)
    
    call etsf_io_data_read("Makefile", grp, lstat, error)
    call tests_read_status("filename: wrong value (text file)", (.not. lstat), error)

    write(*,*)

  end subroutine test_data_read

@READ_GRP@

end program tests_read
